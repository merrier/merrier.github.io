{"title":"一些实用的JS和jQuery方法","slug":"一些实用的JS和jQuery方法","date":"2017-03-15T15:56:27.000Z","updated":"2025-01-03T13:19:00.881Z","comments":true,"path":"api/articles/一些实用的JS和jQuery方法.json","excerpt":null,"covers":null,"content":"<p>这里总结了一些常用的 JS/jQuery 方法，都是一些在项目中经常遇到的功能需求，如果你有更多的建议，欢迎留言</p>\n<blockquote>\n<p>更新于 2018-02-11：在我的github（<a href=\"https://github.com/merrier/common-js\">common-js</a>）上对一些常用的方法进行了总结，都是一些短小精悍但是颇为实用的封装函数，欢迎 star 或 fork:)</p>\n</blockquote>\n<h2 id=\"1、简单的图片预览\"><a href=\"#1、简单的图片预览\" class=\"headerlink\" title=\"1、简单的图片预览\"></a>1、简单的图片预览</h2><p>这个方法就是普通的上传图片并预览功能，不包含进度条以及大小和格式的判断</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//------------------获取图片url地址---------------</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">getObjectURL</span>(<span class=\"params\">file</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> url = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">createObjectURL</span>!=<span class=\"literal\">undefined</span>) &#123; <span class=\"comment\">// basic</span></span><br><span class=\"line\">    url = <span class=\"variable language_\">window</span>.<span class=\"title function_\">createObjectURL</span>(file) ;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">URL</span>!=<span class=\"literal\">undefined</span>) &#123; <span class=\"comment\">// mozilla(firefox)</span></span><br><span class=\"line\">    url = <span class=\"variable language_\">window</span>.<span class=\"property\">URL</span>.<span class=\"title function_\">createObjectURL</span>(file) ;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">webkitURL</span>!=<span class=\"literal\">undefined</span>) &#123; <span class=\"comment\">// webkit or chrome</span></span><br><span class=\"line\">    url = <span class=\"variable language_\">window</span>.<span class=\"property\">webkitURL</span>.<span class=\"title function_\">createObjectURL</span>(file) ;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> url ;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//---------------上传图片按钮点击------------</span></span><br><span class=\"line\">$(<span class=\"string\">&quot;.btn_upload_file&quot;</span>).<span class=\"title function_\">change</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> picurl = <span class=\"title function_\">getObjectURL</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">files</span>[<span class=\"number\">0</span>]);</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(picurl)&#123;</span><br><span class=\"line\">    $(<span class=\"string\">&quot;.div_show_pic&quot;</span>).<span class=\"title function_\">show</span>().<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;src&quot;</span>,picurl);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"2、实现-sleep-函数\"><a href=\"#2、实现-sleep-函数\" class=\"headerlink\" title=\"2、实现 sleep 函数\"></a>2、实现 sleep 函数</h2><p>很多语言都有 sleep 函数，显然 js 没有，所以需要其他的方法“模拟”实现 sleep 函数</p>\n<h3 id=\"方法一：通过比较当前时间\"><a href=\"#方法一：通过比较当前时间\" class=\"headerlink\" title=\"方法一：通过比较当前时间\"></a>方法一：通过比较当前时间</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">sleep</span>(<span class=\"params\">numberMillis</span>) &#123; </span><br><span class=\"line\">  <span class=\"keyword\">var</span> now = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(); </span><br><span class=\"line\">  <span class=\"keyword\">var</span> exitTime = now.<span class=\"title function_\">getTime</span>() + numberMillis; </span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123; </span><br><span class=\"line\">    now = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(); </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (now.<span class=\"title function_\">getTime</span>() &gt; exitTime) </span><br><span class=\"line\">      <span class=\"keyword\">return</span>; </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法二：jQuery-中的-delay-方法\"><a href=\"#方法二：jQuery-中的-delay-方法\" class=\"headerlink\" title=\"方法二：jQuery 中的 $.delay() 方法\"></a>方法二：jQuery 中的 $.delay() 方法</h3><p>下面这个例子：在 slideUp() 和 .fadeIn() 之间延时 800 毫秒</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(<span class=\"string\">&#x27;#foo&#x27;</span>).<span class=\"title function_\">slideUp</span>(<span class=\"number\">300</span>).<span class=\"title function_\">delay</span>(<span class=\"number\">800</span>).<span class=\"title function_\">fadeIn</span>(<span class=\"number\">400</span>);</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法三：setTimeout\"><a href=\"#方法三：setTimeout\" class=\"headerlink\" title=\"方法三：setTimeout\"></a>方法三：setTimeout</h3><p>假设有三个步骤，步骤之间需要暂停一段时间；可以采用如下的方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">firstStep</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">//do something</span></span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"string\">&quot;secondStep()&quot;</span>, <span class=\"number\">1000</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">secondStep</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">//do something</span></span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"string\">&quot;thirdStep()&quot;</span>, <span class=\"number\">1000</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">thirdStep</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">//do something</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法四：ES6-的-promise\"><a href=\"#方法四：ES6-的-promise\" class=\"headerlink\" title=\"方法四：ES6 的 promise\"></a>方法四：ES6 的 promise</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">test</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Hello&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">await</span> <span class=\"title function_\">sleep</span>(<span class=\"number\">1000</span>)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;world!&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">sleep</span>(<span class=\"params\">ms</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> <span class=\"built_in\">setTimeout</span>(resolve, ms))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">test</span>();</span><br></pre></td></tr></table></figure>\n<h2 id=\"3、复制内容后面附加额外内容\"><a href=\"#3、复制内容后面附加额外内容\" class=\"headerlink\" title=\"3、复制内容后面附加额外内容\"></a>3、复制内容后面附加额外内容</h2><p>复制网页上面内容时，自动在剪切板内容后面加上网站信息，这样也利于 SEO 优化：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">oncopy</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;  </span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>)&#123;   </span><br><span class=\"line\">    <span class=\"keyword\">var</span> text = clipboardData.<span class=\"title function_\">getData</span>(<span class=\"string\">&quot;text&quot;</span>);  </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (text) &#123;</span><br><span class=\"line\">      text = text + <span class=\"string\">&quot;\\\\r\\\\n本篇文章来源于 www.地址.COM 原文链接：&quot;</span>+location.<span class=\"property\">href</span>;   </span><br><span class=\"line\">      clipboardData.<span class=\"title function_\">setData</span>(<span class=\"string\">&quot;text&quot;</span>, text); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;, <span class=\"number\">100</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"4、很简单的省略字数\"><a href=\"#4、很简单的省略字数\" class=\"headerlink\" title=\"4、很简单的省略字数\"></a>4、很简单的省略字数</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(<span class=\"string\">&quot;.omit_word_class&quot;</span>).<span class=\"title function_\">each</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> ntext = $(<span class=\"variable language_\">this</span>).<span class=\"title function_\">text</span>();</span><br><span class=\"line\">  <span class=\"keyword\">var</span> nlen = $(<span class=\"variable language_\">this</span>).<span class=\"title function_\">text</span>().<span class=\"property\">length</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(nlen&gt; <span class=\"number\">7</span>)&#123;</span><br><span class=\"line\">    $(<span class=\"variable language_\">this</span>).<span class=\"title function_\">text</span>(ntext.<span class=\"title function_\">substring</span>(<span class=\"number\">0</span>,<span class=\"number\">7</span>) + <span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"5、JS-的动画帧\"><a href=\"#5、JS-的动画帧\" class=\"headerlink\" title=\"5、JS 的动画帧\"></a>5、JS 的动画帧</h2><p>关于 requestAnimationFrame，我对它的理解也很浅层，推荐这篇<a href=\"http://www.zhangxinxu.com/wordpress/2013/09/css3-animation-requestanimationframe-tween-%E5%8A%A8%E7%94%BB%E7%AE%97%E6%B3%95/\">张鑫旭对于requestAnimationFrame的讲解</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">requestAnimFrame</span> = (<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span>  <span class=\"variable language_\">window</span>.<span class=\"property\">requestAnimationFrame</span>       ||</span><br><span class=\"line\">          <span class=\"variable language_\">window</span>.<span class=\"property\">webkitRequestAnimationFrame</span> ||</span><br><span class=\"line\">          <span class=\"variable language_\">window</span>.<span class=\"property\">mozRequestAnimationFrame</span>    ||</span><br><span class=\"line\">          <span class=\"keyword\">function</span>(<span class=\"params\"> callback </span>)&#123;</span><br><span class=\"line\">            <span class=\"variable language_\">window</span>.<span class=\"built_in\">setTimeout</span>(callback, <span class=\"number\">1000</span> / <span class=\"number\">60</span>);</span><br><span class=\"line\">          &#125;;</span><br><span class=\"line\">&#125;)();</span><br></pre></td></tr></table></figure>\n<h2 id=\"6、JS-判断字符串长度\"><a href=\"#6、JS-判断字符串长度\" class=\"headerlink\" title=\"6、JS 判断字符串长度\"></a>6、JS 判断字符串长度</h2><p>方法一，给 String 的 prototype 添加方法</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title class_\">String</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">gblen</span> = <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;    </span><br><span class=\"line\">  <span class=\"keyword\">var</span> len = <span class=\"number\">0</span>;    </span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>; i&lt;<span class=\"variable language_\">this</span>.<span class=\"property\">length</span>; i++) &#123;    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"title function_\">charCodeAt</span>(i)&gt;<span class=\"number\">127</span> || <span class=\"variable language_\">this</span>.<span class=\"title function_\">charCodeAt</span>(i)==<span class=\"number\">94</span>) &#123;    </span><br><span class=\"line\">      len += <span class=\"number\">2</span>;    </span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;    </span><br><span class=\"line\">      len ++;    </span><br><span class=\"line\">    &#125;    </span><br><span class=\"line\">  &#125;    </span><br><span class=\"line\">  <span class=\"keyword\">return</span> len;    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法二，利用-ASCII-码\"><a href=\"#方法二，利用-ASCII-码\" class=\"headerlink\" title=\"方法二，利用 ASCII 码\"></a>方法二，利用 ASCII 码</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">strlen</span>(<span class=\"params\">str</span>)&#123;  </span><br><span class=\"line\">  <span class=\"keyword\">var</span> len = <span class=\"number\">0</span>;  </span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>; i&lt;str.<span class=\"property\">length</span>; i++) &#123;   </span><br><span class=\"line\">    <span class=\"keyword\">var</span> c = str.<span class=\"title function_\">charCodeAt</span>(i);   </span><br><span class=\"line\">    <span class=\"comment\">//单字节加1   </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((c &gt;= <span class=\"number\">0x0001</span> &amp;&amp; c &lt;= <span class=\"number\">0x007e</span>) || (<span class=\"number\">0xff60</span>&lt;=c &amp;&amp; c&lt;=<span class=\"number\">0xff9f</span>)) &#123;   </span><br><span class=\"line\">      len++;   </span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;   </span><br><span class=\"line\">      len+=<span class=\"number\">2</span>;   </span><br><span class=\"line\">    &#125;   </span><br><span class=\"line\">  &#125;   </span><br><span class=\"line\">  <span class=\"keyword\">return</span> len;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法三：把双字节的替换成两个单字节的然后再获得长度\"><a href=\"#方法三：把双字节的替换成两个单字节的然后再获得长度\" class=\"headerlink\" title=\"方法三：把双字节的替换成两个单字节的然后再获得长度\"></a>方法三：把双字节的替换成两个单字节的然后再获得长度</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getBLen = <span class=\"keyword\">function</span>(<span class=\"params\">str</span>) &#123;  </span><br><span class=\"line\">  <span class=\"keyword\">if</span> (str == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;  </span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> str != <span class=\"string\">&quot;string&quot;</span>)&#123;  </span><br><span class=\"line\">    str += <span class=\"string\">&quot;&quot;</span>;  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  <span class=\"keyword\">return</span> str.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/[^\\\\x00-\\\\xff]/g</span>,<span class=\"string\">&quot;01&quot;</span>).<span class=\"property\">length</span>;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"7、jQuery-控制超出规定长度显示省略号\"><a href=\"#7、jQuery-控制超出规定长度显示省略号\" class=\"headerlink\" title=\"7、jQuery 控制超出规定长度显示省略号\"></a>7、jQuery 控制超出规定长度显示省略号</h2><p>给需要显示省略号的标签设置 class 为 displayPart，然后设置自定义属性 displayLength，该属性为可显示长度（不包含…），该方法会区分中英文，中文字符相当于两个字节</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$.fn.<span class=\"title function_\">extend</span>(&#123; </span><br><span class=\"line\">  <span class=\"attr\">displayPart</span>:<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123; </span><br><span class=\"line\">    <span class=\"keyword\">var</span> displayLength = <span class=\"number\">100</span>; </span><br><span class=\"line\">    displayLength = <span class=\"variable language_\">this</span>.<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;displayLength&quot;</span>) || displayLength; </span><br><span class=\"line\">    <span class=\"keyword\">var</span> text = <span class=\"variable language_\">this</span>.<span class=\"title function_\">text</span>(); </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!text) <span class=\"keyword\">return</span> <span class=\"string\">&quot;&quot;</span>; </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> result = <span class=\"string\">&quot;&quot;</span>; </span><br><span class=\"line\">    <span class=\"keyword\">var</span> count = <span class=\"number\">0</span>; </span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; displayLength; i++) &#123; </span><br><span class=\"line\">      <span class=\"keyword\">var</span> _char = text.<span class=\"title function_\">charAt</span>(i); </span><br><span class=\"line\">      <span class=\"keyword\">if</span> (count &gt;= displayLength) <span class=\"keyword\">break</span>; </span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"regexp\">/[^x00-xff]/</span>.<span class=\"title function_\">test</span>(_char)) count++; <span class=\"comment\">//双字节字符，//[u4e00-u9fa5]中文 </span></span><br><span class=\"line\">      result += _char; </span><br><span class=\"line\">      count++; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (result.<span class=\"property\">length</span> &lt; text.<span class=\"property\">length</span>) &#123; </span><br><span class=\"line\">      result += <span class=\"string\">&quot;...&quot;</span>; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">text</span>(result); </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">&#125;); </span><br><span class=\"line\"></span><br><span class=\"line\">$(<span class=\"string\">&quot;.displayPart&quot;</span>).<span class=\"title function_\">each</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">  $(<span class=\"variable language_\">this</span>).<span class=\"title function_\">displayPart</span>();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"8、去除字符串首尾的空白字符\"><a href=\"#8、去除字符串首尾的空白字符\" class=\"headerlink\" title=\"8、去除字符串首尾的空白字符\"></a>8、去除字符串首尾的空白字符</h2><p>如果引入了 jQuery，可以直接利用 $.trim() 方法，如果没有就需要用到下面的正则表达式</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">trim</span>(<span class=\"params\">ostr</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ostr.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^\\\\s+|\\\\s+$/g</span>,<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"9、判断数组中是否包含某个元素\"><a href=\"#9、判断数组中是否包含某个元素\" class=\"headerlink\" title=\"9、判断数组中是否包含某个元素\"></a>9、判断数组中是否包含某个元素</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [ <span class=\"string\">&quot;xml&quot;</span>, <span class=\"string\">&quot;html&quot;</span>, <span class=\"string\">&quot;css&quot;</span>, <span class=\"string\">&quot;js&quot;</span> ];  </span><br><span class=\"line\">$.<span class=\"title function_\">inArray</span>(<span class=\"string\">&quot;js&quot;</span>, arr);  <span class=\"comment\">// 返回 3, 如果不包含在数组中, 则返回 -1;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"10、获取日期并格式化\"><a href=\"#10、获取日期并格式化\" class=\"headerlink\" title=\"10、获取日期并格式化\"></a>10、获取日期并格式化</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"keyword\">function</span> <span class=\"title function_\">getDateStr</span>(<span class=\"params\">AddDayCount</span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> dd = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">  dd.<span class=\"title function_\">setDate</span>(dd.<span class=\"title function_\">getDate</span>()+<span class=\"title class_\">AddDayCount</span>);<span class=\"comment\">//获取AddDayCount天后的日期</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> y = dd.<span class=\"title function_\">getFullYear</span>();</span><br><span class=\"line\">  <span class=\"keyword\">var</span> m = dd.<span class=\"title function_\">getMonth</span>()+<span class=\"number\">1</span>;<span class=\"comment\">//获取当前月份的日期</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> d = dd.<span class=\"title function_\">getDate</span>();</span><br><span class=\"line\">  <span class=\"keyword\">return</span> y+<span class=\"string\">&quot;-&quot;</span>+m+<span class=\"string\">&quot;-&quot;</span>+d;</span><br><span class=\"line\">&#125;)(-<span class=\"number\">2</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"11、根据屏幕宽度改变-html-的-font-size-大小\"><a href=\"#11、根据屏幕宽度改变-html-的-font-size-大小\" class=\"headerlink\" title=\"11、根据屏幕宽度改变 html 的 font-size 大小\"></a>11、根据屏幕宽度改变 html 的 font-size 大小</h2><p>结合 REM 可以很轻松的实现移动端的响应式大小效果</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"keyword\">function</span>(<span class=\"params\">win</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">setUnitA</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">documentElement</span>.<span class=\"property\">style</span>.<span class=\"property\">fontSize</span> = <span class=\"variable language_\">document</span>.<span class=\"property\">documentElement</span>.<span class=\"property\">clientWidth</span> / <span class=\"number\">16</span> + <span class=\"string\">&quot;px&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> h = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&quot;resize&quot;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">clearTimeout</span>(h);</span><br><span class=\"line\">    h = <span class=\"built_in\">setTimeout</span>(setUnitA, <span class=\"number\">300</span>);</span><br><span class=\"line\">  &#125;, <span class=\"literal\">false</span>);</span><br><span class=\"line\">  <span class=\"title function_\">setUnitA</span>();</span><br><span class=\"line\">&#125;)(<span class=\"variable language_\">window</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"12、JS-jQuery-获取-url-参数\"><a href=\"#12、JS-jQuery-获取-url-参数\" class=\"headerlink\" title=\"12、JS/jQuery 获取 url 参数\"></a>12、JS/jQuery 获取 url 参数</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//---------------javaseript获取url中的参数----------------</span></span><br><span class=\"line\"><span class=\"comment\">//\\* 用法：</span></span><br><span class=\"line\"><span class=\"comment\">//\\* var args = getArgs( ); // 从 URL 解析出参数</span></span><br><span class=\"line\"><span class=\"comment\">//\\* var q = args.q || &quot;&quot;; // 如果定义了某参数，则使用其值，否则给它一个默认值</span></span><br><span class=\"line\"><span class=\"comment\">//\\* var n = args.n ? parseInt(args.n) : 10;</span></span><br><span class=\"line\"><span class=\"comment\">//*/</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> getArgs = <span class=\"keyword\">function</span> (<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> args = <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>( ); <span class=\"comment\">//声明一个空对象</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> query = <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">search</span>.<span class=\"title function_\">substring</span>(<span class=\"number\">1</span>); <span class=\"comment\">// 取查询字符串，如从 http://www.snowpeak.org/testjs.htm?a1=v1&amp;a2=&amp;a3=v3#anchor 中截出 a1=v1&amp;a2=&amp;a3=v3。</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> pairs = query.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;&amp;&quot;</span>); <span class=\"comment\">// 以 &amp; 符分开成数组</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; pairs.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> pos = pairs[i].<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;=&#x27;</span>); <span class=\"comment\">// 查找 &quot;name=value&quot; 对</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pos == -<span class=\"number\">1</span>) <span class=\"keyword\">continue</span>; <span class=\"comment\">// 若不成对，则跳出循环继续下一对</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> argname = pairs[i].<span class=\"title function_\">substring</span>(<span class=\"number\">0</span>,pos); <span class=\"comment\">// 取参数名</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> value = pairs[i].<span class=\"title function_\">substring</span>(pos+<span class=\"number\">1</span>); <span class=\"comment\">// 取参数值</span></span><br><span class=\"line\">        value = <span class=\"built_in\">decodeURIComponent</span>(value); <span class=\"comment\">// 若需要，则解码</span></span><br><span class=\"line\">        args[argname] = value; <span class=\"comment\">// 存成对象的一个属性</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> args; <span class=\"comment\">// 返回此对象</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"13、返回一个最小值与最大值中间的随机值\"><a href=\"#13、返回一个最小值与最大值中间的随机值\" class=\"headerlink\" title=\"13、返回一个最小值与最大值中间的随机值\"></a>13、返回一个最小值与最大值中间的随机值</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">random</span>(<span class=\"params\">min,max</span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> min + (max - min) * <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"14、限制上传文件格式和大小\"><a href=\"#14、限制上传文件格式和大小\" class=\"headerlink\" title=\"14、限制上传文件格式和大小\"></a>14、限制上传文件格式和大小</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">fileChange</span>(<span class=\"params\">target</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> name=target.<span class=\"property\">value</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> fileType = name.<span class=\"title function_\">substring</span>(name.<span class=\"title function_\">lastIndexOf</span>(<span class=\"string\">&quot;.&quot;</span>)+<span class=\"number\">1</span>).<span class=\"title function_\">toLowerCase</span>();     <span class=\"comment\">// 获取文件格式</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> fileArr=name.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;\\\\\\&quot;);</span></span><br><span class=\"line\"><span class=\"string\">    var fileName=fileArr[fileArr.length-1];     // 获取文件名称</span></span><br><span class=\"line\"><span class=\"string\">    if(fileType !=&quot;</span>jpg<span class=\"string\">&quot; &amp;&amp; fileType !=&quot;</span>png<span class=\"string\">&quot;)&#123;</span></span><br><span class=\"line\"><span class=\"string\">        alert(&quot;</span>请选择jpg或者png格式图片文件上传！<span class=\"string\">&quot;);</span></span><br><span class=\"line\"><span class=\"string\">        target.value=&quot;</span><span class=\"string\">&quot;;</span></span><br><span class=\"line\"><span class=\"string\">        return false;</span></span><br><span class=\"line\"><span class=\"string\">    &#125;else&#123;</span></span><br><span class=\"line\"><span class=\"string\">        var fileSize = target.files[0].size/1024;           // 获取文件大小，单位为kb</span></span><br><span class=\"line\"><span class=\"string\">        console.log(fileSize);</span></span><br><span class=\"line\"><span class=\"string\">        if (fileSize &gt; 40) &#123;</span></span><br><span class=\"line\"><span class=\"string\">            alert(&quot;</span>图片文件大小不得超过40kb!<span class=\"string\">&quot;);</span></span><br><span class=\"line\"><span class=\"string\">            target.value=&quot;</span><span class=\"string\">&quot;;</span></span><br><span class=\"line\"><span class=\"string\">            return false;</span></span><br><span class=\"line\"><span class=\"string\">        &#125;else&#123;</span></span><br><span class=\"line\"><span class=\"string\">            var url=getObjectURL(target.files[0]);           // 获取图片url</span></span><br><span class=\"line\"><span class=\"string\">            console.log(url);</span></span><br><span class=\"line\"><span class=\"string\">            $(&quot;</span>.<span class=\"property\">modal_brand</span> .<span class=\"property\">upload_img</span><span class=\"string\">&quot;).attr(&quot;</span>src<span class=\"string\">&quot;,url);      // 显示上传图片</span></span><br><span class=\"line\"><span class=\"string\">            console.log($(&quot;</span>.<span class=\"property\">modal_brand</span> .<span class=\"property\">upload_img</span><span class=\"string\">&quot;).attr(&quot;</span>src<span class=\"string\">&quot;));</span></span><br><span class=\"line\"><span class=\"string\">            $(&quot;</span>.<span class=\"property\">modal_brand</span> .<span class=\"property\">img_name</span> p<span class=\"string\">&quot;).text(fileName);          // 显示上传图片文件名</span></span><br><span class=\"line\"><span class=\"string\">        &#125;</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"15、一个-HTML-转义函数\"><a href=\"#15、一个-HTML-转义函数\" class=\"headerlink\" title=\"15、一个 HTML 转义函数\"></a>15、一个 HTML 转义函数</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">escapeHTML</span>(<span class=\"params\">text</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> replacements= &#123;<span class=\"string\">&quot;&lt;&quot;</span>: <span class=\"string\">&quot;&lt;&quot;</span>, <span class=\"string\">&quot;&gt;&quot;</span>: <span class=\"string\">&quot;&gt;&quot;</span>,<span class=\"string\">&quot;&amp;&quot;</span>: <span class=\"string\">&quot;&amp;&quot;</span>, <span class=\"string\">&quot;\\\\&quot;</span><span class=\"string\">&quot;: &quot;</span><span class=\"string\">&quot;&quot;</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> text.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/[&lt;&gt;&amp;&quot;]/g</span>, <span class=\"keyword\">function</span>(<span class=\"params\">character</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> replacements[character];</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","more":"<p>这里总结了一些常用的 JS/jQuery 方法，都是一些在项目中经常遇到的功能需求，如果你有更多的建议，欢迎留言</p>\n<blockquote>\n<p>更新于 2018-02-11：在我的github（<a href=\"https://github.com/merrier/common-js\">common-js</a>）上对一些常用的方法进行了总结，都是一些短小精悍但是颇为实用的封装函数，欢迎 star 或 fork:)</p>\n</blockquote>\n<h2 id=\"1、简单的图片预览\"><a href=\"#1、简单的图片预览\" class=\"headerlink\" title=\"1、简单的图片预览\"></a>1、简单的图片预览</h2><p>这个方法就是普通的上传图片并预览功能，不包含进度条以及大小和格式的判断</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//------------------获取图片url地址---------------</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">getObjectURL</span>(<span class=\"params\">file</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> url = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">createObjectURL</span>!=<span class=\"literal\">undefined</span>) &#123; <span class=\"comment\">// basic</span></span><br><span class=\"line\">    url = <span class=\"variable language_\">window</span>.<span class=\"title function_\">createObjectURL</span>(file) ;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">URL</span>!=<span class=\"literal\">undefined</span>) &#123; <span class=\"comment\">// mozilla(firefox)</span></span><br><span class=\"line\">    url = <span class=\"variable language_\">window</span>.<span class=\"property\">URL</span>.<span class=\"title function_\">createObjectURL</span>(file) ;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">webkitURL</span>!=<span class=\"literal\">undefined</span>) &#123; <span class=\"comment\">// webkit or chrome</span></span><br><span class=\"line\">    url = <span class=\"variable language_\">window</span>.<span class=\"property\">webkitURL</span>.<span class=\"title function_\">createObjectURL</span>(file) ;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> url ;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//---------------上传图片按钮点击------------</span></span><br><span class=\"line\">$(<span class=\"string\">&quot;.btn_upload_file&quot;</span>).<span class=\"title function_\">change</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> picurl = <span class=\"title function_\">getObjectURL</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">files</span>[<span class=\"number\">0</span>]);</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(picurl)&#123;</span><br><span class=\"line\">    $(<span class=\"string\">&quot;.div_show_pic&quot;</span>).<span class=\"title function_\">show</span>().<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;src&quot;</span>,picurl);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"2、实现-sleep-函数\"><a href=\"#2、实现-sleep-函数\" class=\"headerlink\" title=\"2、实现 sleep 函数\"></a>2、实现 sleep 函数</h2><p>很多语言都有 sleep 函数，显然 js 没有，所以需要其他的方法“模拟”实现 sleep 函数</p>\n<h3 id=\"方法一：通过比较当前时间\"><a href=\"#方法一：通过比较当前时间\" class=\"headerlink\" title=\"方法一：通过比较当前时间\"></a>方法一：通过比较当前时间</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">sleep</span>(<span class=\"params\">numberMillis</span>) &#123; </span><br><span class=\"line\">  <span class=\"keyword\">var</span> now = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(); </span><br><span class=\"line\">  <span class=\"keyword\">var</span> exitTime = now.<span class=\"title function_\">getTime</span>() + numberMillis; </span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123; </span><br><span class=\"line\">    now = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(); </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (now.<span class=\"title function_\">getTime</span>() &gt; exitTime) </span><br><span class=\"line\">      <span class=\"keyword\">return</span>; </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法二：jQuery-中的-delay-方法\"><a href=\"#方法二：jQuery-中的-delay-方法\" class=\"headerlink\" title=\"方法二：jQuery 中的 $.delay() 方法\"></a>方法二：jQuery 中的 $.delay() 方法</h3><p>下面这个例子：在 slideUp() 和 .fadeIn() 之间延时 800 毫秒</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(<span class=\"string\">&#x27;#foo&#x27;</span>).<span class=\"title function_\">slideUp</span>(<span class=\"number\">300</span>).<span class=\"title function_\">delay</span>(<span class=\"number\">800</span>).<span class=\"title function_\">fadeIn</span>(<span class=\"number\">400</span>);</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法三：setTimeout\"><a href=\"#方法三：setTimeout\" class=\"headerlink\" title=\"方法三：setTimeout\"></a>方法三：setTimeout</h3><p>假设有三个步骤，步骤之间需要暂停一段时间；可以采用如下的方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">firstStep</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">//do something</span></span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"string\">&quot;secondStep()&quot;</span>, <span class=\"number\">1000</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">secondStep</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">//do something</span></span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"string\">&quot;thirdStep()&quot;</span>, <span class=\"number\">1000</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">thirdStep</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">//do something</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法四：ES6-的-promise\"><a href=\"#方法四：ES6-的-promise\" class=\"headerlink\" title=\"方法四：ES6 的 promise\"></a>方法四：ES6 的 promise</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">test</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Hello&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">await</span> <span class=\"title function_\">sleep</span>(<span class=\"number\">1000</span>)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;world!&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">sleep</span>(<span class=\"params\">ms</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> <span class=\"built_in\">setTimeout</span>(resolve, ms))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">test</span>();</span><br></pre></td></tr></table></figure>\n<h2 id=\"3、复制内容后面附加额外内容\"><a href=\"#3、复制内容后面附加额外内容\" class=\"headerlink\" title=\"3、复制内容后面附加额外内容\"></a>3、复制内容后面附加额外内容</h2><p>复制网页上面内容时，自动在剪切板内容后面加上网站信息，这样也利于 SEO 优化：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">oncopy</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;  </span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>)&#123;   </span><br><span class=\"line\">    <span class=\"keyword\">var</span> text = clipboardData.<span class=\"title function_\">getData</span>(<span class=\"string\">&quot;text&quot;</span>);  </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (text) &#123;</span><br><span class=\"line\">      text = text + <span class=\"string\">&quot;\\\\r\\\\n本篇文章来源于 www.地址.COM 原文链接：&quot;</span>+location.<span class=\"property\">href</span>;   </span><br><span class=\"line\">      clipboardData.<span class=\"title function_\">setData</span>(<span class=\"string\">&quot;text&quot;</span>, text); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;, <span class=\"number\">100</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"4、很简单的省略字数\"><a href=\"#4、很简单的省略字数\" class=\"headerlink\" title=\"4、很简单的省略字数\"></a>4、很简单的省略字数</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(<span class=\"string\">&quot;.omit_word_class&quot;</span>).<span class=\"title function_\">each</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> ntext = $(<span class=\"variable language_\">this</span>).<span class=\"title function_\">text</span>();</span><br><span class=\"line\">  <span class=\"keyword\">var</span> nlen = $(<span class=\"variable language_\">this</span>).<span class=\"title function_\">text</span>().<span class=\"property\">length</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(nlen&gt; <span class=\"number\">7</span>)&#123;</span><br><span class=\"line\">    $(<span class=\"variable language_\">this</span>).<span class=\"title function_\">text</span>(ntext.<span class=\"title function_\">substring</span>(<span class=\"number\">0</span>,<span class=\"number\">7</span>) + <span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"5、JS-的动画帧\"><a href=\"#5、JS-的动画帧\" class=\"headerlink\" title=\"5、JS 的动画帧\"></a>5、JS 的动画帧</h2><p>关于 requestAnimationFrame，我对它的理解也很浅层，推荐这篇<a href=\"http://www.zhangxinxu.com/wordpress/2013/09/css3-animation-requestanimationframe-tween-%E5%8A%A8%E7%94%BB%E7%AE%97%E6%B3%95/\">张鑫旭对于requestAnimationFrame的讲解</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">requestAnimFrame</span> = (<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span>  <span class=\"variable language_\">window</span>.<span class=\"property\">requestAnimationFrame</span>       ||</span><br><span class=\"line\">          <span class=\"variable language_\">window</span>.<span class=\"property\">webkitRequestAnimationFrame</span> ||</span><br><span class=\"line\">          <span class=\"variable language_\">window</span>.<span class=\"property\">mozRequestAnimationFrame</span>    ||</span><br><span class=\"line\">          <span class=\"keyword\">function</span>(<span class=\"params\"> callback </span>)&#123;</span><br><span class=\"line\">            <span class=\"variable language_\">window</span>.<span class=\"built_in\">setTimeout</span>(callback, <span class=\"number\">1000</span> / <span class=\"number\">60</span>);</span><br><span class=\"line\">          &#125;;</span><br><span class=\"line\">&#125;)();</span><br></pre></td></tr></table></figure>\n<h2 id=\"6、JS-判断字符串长度\"><a href=\"#6、JS-判断字符串长度\" class=\"headerlink\" title=\"6、JS 判断字符串长度\"></a>6、JS 判断字符串长度</h2><p>方法一，给 String 的 prototype 添加方法</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title class_\">String</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">gblen</span> = <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;    </span><br><span class=\"line\">  <span class=\"keyword\">var</span> len = <span class=\"number\">0</span>;    </span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>; i&lt;<span class=\"variable language_\">this</span>.<span class=\"property\">length</span>; i++) &#123;    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"title function_\">charCodeAt</span>(i)&gt;<span class=\"number\">127</span> || <span class=\"variable language_\">this</span>.<span class=\"title function_\">charCodeAt</span>(i)==<span class=\"number\">94</span>) &#123;    </span><br><span class=\"line\">      len += <span class=\"number\">2</span>;    </span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;    </span><br><span class=\"line\">      len ++;    </span><br><span class=\"line\">    &#125;    </span><br><span class=\"line\">  &#125;    </span><br><span class=\"line\">  <span class=\"keyword\">return</span> len;    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法二，利用-ASCII-码\"><a href=\"#方法二，利用-ASCII-码\" class=\"headerlink\" title=\"方法二，利用 ASCII 码\"></a>方法二，利用 ASCII 码</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">strlen</span>(<span class=\"params\">str</span>)&#123;  </span><br><span class=\"line\">  <span class=\"keyword\">var</span> len = <span class=\"number\">0</span>;  </span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>; i&lt;str.<span class=\"property\">length</span>; i++) &#123;   </span><br><span class=\"line\">    <span class=\"keyword\">var</span> c = str.<span class=\"title function_\">charCodeAt</span>(i);   </span><br><span class=\"line\">    <span class=\"comment\">//单字节加1   </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((c &gt;= <span class=\"number\">0x0001</span> &amp;&amp; c &lt;= <span class=\"number\">0x007e</span>) || (<span class=\"number\">0xff60</span>&lt;=c &amp;&amp; c&lt;=<span class=\"number\">0xff9f</span>)) &#123;   </span><br><span class=\"line\">      len++;   </span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;   </span><br><span class=\"line\">      len+=<span class=\"number\">2</span>;   </span><br><span class=\"line\">    &#125;   </span><br><span class=\"line\">  &#125;   </span><br><span class=\"line\">  <span class=\"keyword\">return</span> len;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"方法三：把双字节的替换成两个单字节的然后再获得长度\"><a href=\"#方法三：把双字节的替换成两个单字节的然后再获得长度\" class=\"headerlink\" title=\"方法三：把双字节的替换成两个单字节的然后再获得长度\"></a>方法三：把双字节的替换成两个单字节的然后再获得长度</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getBLen = <span class=\"keyword\">function</span>(<span class=\"params\">str</span>) &#123;  </span><br><span class=\"line\">  <span class=\"keyword\">if</span> (str == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;  </span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> str != <span class=\"string\">&quot;string&quot;</span>)&#123;  </span><br><span class=\"line\">    str += <span class=\"string\">&quot;&quot;</span>;  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  <span class=\"keyword\">return</span> str.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/[^\\\\x00-\\\\xff]/g</span>,<span class=\"string\">&quot;01&quot;</span>).<span class=\"property\">length</span>;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"7、jQuery-控制超出规定长度显示省略号\"><a href=\"#7、jQuery-控制超出规定长度显示省略号\" class=\"headerlink\" title=\"7、jQuery 控制超出规定长度显示省略号\"></a>7、jQuery 控制超出规定长度显示省略号</h2><p>给需要显示省略号的标签设置 class 为 displayPart，然后设置自定义属性 displayLength，该属性为可显示长度（不包含…），该方法会区分中英文，中文字符相当于两个字节</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$.fn.<span class=\"title function_\">extend</span>(&#123; </span><br><span class=\"line\">  <span class=\"attr\">displayPart</span>:<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123; </span><br><span class=\"line\">    <span class=\"keyword\">var</span> displayLength = <span class=\"number\">100</span>; </span><br><span class=\"line\">    displayLength = <span class=\"variable language_\">this</span>.<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;displayLength&quot;</span>) || displayLength; </span><br><span class=\"line\">    <span class=\"keyword\">var</span> text = <span class=\"variable language_\">this</span>.<span class=\"title function_\">text</span>(); </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!text) <span class=\"keyword\">return</span> <span class=\"string\">&quot;&quot;</span>; </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> result = <span class=\"string\">&quot;&quot;</span>; </span><br><span class=\"line\">    <span class=\"keyword\">var</span> count = <span class=\"number\">0</span>; </span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; displayLength; i++) &#123; </span><br><span class=\"line\">      <span class=\"keyword\">var</span> _char = text.<span class=\"title function_\">charAt</span>(i); </span><br><span class=\"line\">      <span class=\"keyword\">if</span> (count &gt;= displayLength) <span class=\"keyword\">break</span>; </span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"regexp\">/[^x00-xff]/</span>.<span class=\"title function_\">test</span>(_char)) count++; <span class=\"comment\">//双字节字符，//[u4e00-u9fa5]中文 </span></span><br><span class=\"line\">      result += _char; </span><br><span class=\"line\">      count++; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (result.<span class=\"property\">length</span> &lt; text.<span class=\"property\">length</span>) &#123; </span><br><span class=\"line\">      result += <span class=\"string\">&quot;...&quot;</span>; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">text</span>(result); </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">&#125;); </span><br><span class=\"line\"></span><br><span class=\"line\">$(<span class=\"string\">&quot;.displayPart&quot;</span>).<span class=\"title function_\">each</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">  $(<span class=\"variable language_\">this</span>).<span class=\"title function_\">displayPart</span>();</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"8、去除字符串首尾的空白字符\"><a href=\"#8、去除字符串首尾的空白字符\" class=\"headerlink\" title=\"8、去除字符串首尾的空白字符\"></a>8、去除字符串首尾的空白字符</h2><p>如果引入了 jQuery，可以直接利用 $.trim() 方法，如果没有就需要用到下面的正则表达式</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">trim</span>(<span class=\"params\">ostr</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ostr.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^\\\\s+|\\\\s+$/g</span>,<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"9、判断数组中是否包含某个元素\"><a href=\"#9、判断数组中是否包含某个元素\" class=\"headerlink\" title=\"9、判断数组中是否包含某个元素\"></a>9、判断数组中是否包含某个元素</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [ <span class=\"string\">&quot;xml&quot;</span>, <span class=\"string\">&quot;html&quot;</span>, <span class=\"string\">&quot;css&quot;</span>, <span class=\"string\">&quot;js&quot;</span> ];  </span><br><span class=\"line\">$.<span class=\"title function_\">inArray</span>(<span class=\"string\">&quot;js&quot;</span>, arr);  <span class=\"comment\">// 返回 3, 如果不包含在数组中, 则返回 -1;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"10、获取日期并格式化\"><a href=\"#10、获取日期并格式化\" class=\"headerlink\" title=\"10、获取日期并格式化\"></a>10、获取日期并格式化</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"keyword\">function</span> <span class=\"title function_\">getDateStr</span>(<span class=\"params\">AddDayCount</span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> dd = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">  dd.<span class=\"title function_\">setDate</span>(dd.<span class=\"title function_\">getDate</span>()+<span class=\"title class_\">AddDayCount</span>);<span class=\"comment\">//获取AddDayCount天后的日期</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> y = dd.<span class=\"title function_\">getFullYear</span>();</span><br><span class=\"line\">  <span class=\"keyword\">var</span> m = dd.<span class=\"title function_\">getMonth</span>()+<span class=\"number\">1</span>;<span class=\"comment\">//获取当前月份的日期</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> d = dd.<span class=\"title function_\">getDate</span>();</span><br><span class=\"line\">  <span class=\"keyword\">return</span> y+<span class=\"string\">&quot;-&quot;</span>+m+<span class=\"string\">&quot;-&quot;</span>+d;</span><br><span class=\"line\">&#125;)(-<span class=\"number\">2</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"11、根据屏幕宽度改变-html-的-font-size-大小\"><a href=\"#11、根据屏幕宽度改变-html-的-font-size-大小\" class=\"headerlink\" title=\"11、根据屏幕宽度改变 html 的 font-size 大小\"></a>11、根据屏幕宽度改变 html 的 font-size 大小</h2><p>结合 REM 可以很轻松的实现移动端的响应式大小效果</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"keyword\">function</span>(<span class=\"params\">win</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">setUnitA</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">documentElement</span>.<span class=\"property\">style</span>.<span class=\"property\">fontSize</span> = <span class=\"variable language_\">document</span>.<span class=\"property\">documentElement</span>.<span class=\"property\">clientWidth</span> / <span class=\"number\">16</span> + <span class=\"string\">&quot;px&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> h = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&quot;resize&quot;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">clearTimeout</span>(h);</span><br><span class=\"line\">    h = <span class=\"built_in\">setTimeout</span>(setUnitA, <span class=\"number\">300</span>);</span><br><span class=\"line\">  &#125;, <span class=\"literal\">false</span>);</span><br><span class=\"line\">  <span class=\"title function_\">setUnitA</span>();</span><br><span class=\"line\">&#125;)(<span class=\"variable language_\">window</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"12、JS-jQuery-获取-url-参数\"><a href=\"#12、JS-jQuery-获取-url-参数\" class=\"headerlink\" title=\"12、JS/jQuery 获取 url 参数\"></a>12、JS/jQuery 获取 url 参数</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//---------------javaseript获取url中的参数----------------</span></span><br><span class=\"line\"><span class=\"comment\">//\\* 用法：</span></span><br><span class=\"line\"><span class=\"comment\">//\\* var args = getArgs( ); // 从 URL 解析出参数</span></span><br><span class=\"line\"><span class=\"comment\">//\\* var q = args.q || &quot;&quot;; // 如果定义了某参数，则使用其值，否则给它一个默认值</span></span><br><span class=\"line\"><span class=\"comment\">//\\* var n = args.n ? parseInt(args.n) : 10;</span></span><br><span class=\"line\"><span class=\"comment\">//*/</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> getArgs = <span class=\"keyword\">function</span> (<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> args = <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>( ); <span class=\"comment\">//声明一个空对象</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> query = <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">search</span>.<span class=\"title function_\">substring</span>(<span class=\"number\">1</span>); <span class=\"comment\">// 取查询字符串，如从 http://www.snowpeak.org/testjs.htm?a1=v1&amp;a2=&amp;a3=v3#anchor 中截出 a1=v1&amp;a2=&amp;a3=v3。</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> pairs = query.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;&amp;&quot;</span>); <span class=\"comment\">// 以 &amp; 符分开成数组</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; pairs.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> pos = pairs[i].<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;=&#x27;</span>); <span class=\"comment\">// 查找 &quot;name=value&quot; 对</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pos == -<span class=\"number\">1</span>) <span class=\"keyword\">continue</span>; <span class=\"comment\">// 若不成对，则跳出循环继续下一对</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> argname = pairs[i].<span class=\"title function_\">substring</span>(<span class=\"number\">0</span>,pos); <span class=\"comment\">// 取参数名</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> value = pairs[i].<span class=\"title function_\">substring</span>(pos+<span class=\"number\">1</span>); <span class=\"comment\">// 取参数值</span></span><br><span class=\"line\">        value = <span class=\"built_in\">decodeURIComponent</span>(value); <span class=\"comment\">// 若需要，则解码</span></span><br><span class=\"line\">        args[argname] = value; <span class=\"comment\">// 存成对象的一个属性</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> args; <span class=\"comment\">// 返回此对象</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"13、返回一个最小值与最大值中间的随机值\"><a href=\"#13、返回一个最小值与最大值中间的随机值\" class=\"headerlink\" title=\"13、返回一个最小值与最大值中间的随机值\"></a>13、返回一个最小值与最大值中间的随机值</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">random</span>(<span class=\"params\">min,max</span>)&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> min + (max - min) * <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"14、限制上传文件格式和大小\"><a href=\"#14、限制上传文件格式和大小\" class=\"headerlink\" title=\"14、限制上传文件格式和大小\"></a>14、限制上传文件格式和大小</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">fileChange</span>(<span class=\"params\">target</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> name=target.<span class=\"property\">value</span>;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> fileType = name.<span class=\"title function_\">substring</span>(name.<span class=\"title function_\">lastIndexOf</span>(<span class=\"string\">&quot;.&quot;</span>)+<span class=\"number\">1</span>).<span class=\"title function_\">toLowerCase</span>();     <span class=\"comment\">// 获取文件格式</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> fileArr=name.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;\\\\\\&quot;);</span></span><br><span class=\"line\"><span class=\"string\">    var fileName=fileArr[fileArr.length-1];     // 获取文件名称</span></span><br><span class=\"line\"><span class=\"string\">    if(fileType !=&quot;</span>jpg<span class=\"string\">&quot; &amp;&amp; fileType !=&quot;</span>png<span class=\"string\">&quot;)&#123;</span></span><br><span class=\"line\"><span class=\"string\">        alert(&quot;</span>请选择jpg或者png格式图片文件上传！<span class=\"string\">&quot;);</span></span><br><span class=\"line\"><span class=\"string\">        target.value=&quot;</span><span class=\"string\">&quot;;</span></span><br><span class=\"line\"><span class=\"string\">        return false;</span></span><br><span class=\"line\"><span class=\"string\">    &#125;else&#123;</span></span><br><span class=\"line\"><span class=\"string\">        var fileSize = target.files[0].size/1024;           // 获取文件大小，单位为kb</span></span><br><span class=\"line\"><span class=\"string\">        console.log(fileSize);</span></span><br><span class=\"line\"><span class=\"string\">        if (fileSize &gt; 40) &#123;</span></span><br><span class=\"line\"><span class=\"string\">            alert(&quot;</span>图片文件大小不得超过40kb!<span class=\"string\">&quot;);</span></span><br><span class=\"line\"><span class=\"string\">            target.value=&quot;</span><span class=\"string\">&quot;;</span></span><br><span class=\"line\"><span class=\"string\">            return false;</span></span><br><span class=\"line\"><span class=\"string\">        &#125;else&#123;</span></span><br><span class=\"line\"><span class=\"string\">            var url=getObjectURL(target.files[0]);           // 获取图片url</span></span><br><span class=\"line\"><span class=\"string\">            console.log(url);</span></span><br><span class=\"line\"><span class=\"string\">            $(&quot;</span>.<span class=\"property\">modal_brand</span> .<span class=\"property\">upload_img</span><span class=\"string\">&quot;).attr(&quot;</span>src<span class=\"string\">&quot;,url);      // 显示上传图片</span></span><br><span class=\"line\"><span class=\"string\">            console.log($(&quot;</span>.<span class=\"property\">modal_brand</span> .<span class=\"property\">upload_img</span><span class=\"string\">&quot;).attr(&quot;</span>src<span class=\"string\">&quot;));</span></span><br><span class=\"line\"><span class=\"string\">            $(&quot;</span>.<span class=\"property\">modal_brand</span> .<span class=\"property\">img_name</span> p<span class=\"string\">&quot;).text(fileName);          // 显示上传图片文件名</span></span><br><span class=\"line\"><span class=\"string\">        &#125;</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"15、一个-HTML-转义函数\"><a href=\"#15、一个-HTML-转义函数\" class=\"headerlink\" title=\"15、一个 HTML 转义函数\"></a>15、一个 HTML 转义函数</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">escapeHTML</span>(<span class=\"params\">text</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> replacements= &#123;<span class=\"string\">&quot;&lt;&quot;</span>: <span class=\"string\">&quot;&lt;&quot;</span>, <span class=\"string\">&quot;&gt;&quot;</span>: <span class=\"string\">&quot;&gt;&quot;</span>,<span class=\"string\">&quot;&amp;&quot;</span>: <span class=\"string\">&quot;&amp;&quot;</span>, <span class=\"string\">&quot;\\\\&quot;</span><span class=\"string\">&quot;: &quot;</span><span class=\"string\">&quot;&quot;</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> text.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/[&lt;&gt;&amp;&quot;]/g</span>, <span class=\"keyword\">function</span>(<span class=\"params\">character</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> replacements[character];</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","categories":[{"name":"JS","path":"api/categories/JS.json"}],"tags":[{"name":"JS","path":"api/tags/JS.json"},{"name":"jQuery","path":"api/tags/jQuery.json"}]}